---
title: "Divorce Prediction"
author: "Elouan-Joris"
date: "2025-09-30"
output:
  html_document:
    toc: true                # ‚úÖ active la table des mati√®res
    toc_float: true          # ‚úÖ menu d√©roulant flottant sur le c√¥t√©
    number_sections: true    # ‚úÖ num√©rotation des sections
    theme: cosmo             # üåà th√®me visuel (cosmo, united, journal, etc.)
    highlight: tango         # üé® style pour le code
    code_folding: show       # üîΩ possibilit√© de plier/d√©plier le code
    df_print: default
  
---


```{r setup, echo = FALSE}
knitr::opts_chunk$set(
	echo = TRUE,
	message = FALSE,
	warning = FALSE
)
```

```{r package, echo=FALSE, message=FALSE, warning=FALSE, paged.print=FALSE}
library(knitr)
library(kableExtra)
library(dplyr)

```

# - Introduction

```{r 1 Chargement du fichier divorce_df.csv, echo = FALSE}
data.brute = read.csv("divorce_df.csv")
```
## - Presentation des variables


```{r echo = FALSE}

# Cr√©ation du dataframe

Nom_de_la_variable = c("age_at_marriage","marriage_duration_years","divorced","num_children",
                         "education_level","employment_status","combined_income",
                         "religious_compatibility","cultural_background_match","communication_score",
                         "conflict_frequency","conflict_resolution_style","mental_health_issues",
                         "financial_stress_level","infidelity_occurred","counseling_attended",
                         "social_support","shared_hobbies_count","marriage_type",
                         "pre_marital_cohabitation","domestic_violence_history","trust_score")

Description = c("√Çge au mariage","Dur√©e du mariage","Divorce (oui/non)","Nombre d‚Äôenfants",
                  "Niveau d‚Äô√©ducation","Statut professionnel","Revenu combin√©",
                  "Compatibilit√© religieuse","Correspondance culturelle","Score de communication",
                  "Fr√©quence des conflits","Style de r√©solution de conflit","Probl√®mes de sant√© mentale",
                  "Niveau de stress financier","Infid√©lit√© survenue","A suivi un counseling",
                  "Soutien social","Nombre de hobbies partag√©s","Type de mariage",
                  "Cohabitation avant mariage","Historique de violence domestique","Score de confiance")

Type = c("Quantitative","Quantitative","Qualitative","Quantitative","Qualitative",
           "Qualitative","Quantitative","Qualitative","Qualitative","Quantitative",
           "Quantitative","Qualitative","Qualitative","Quantitative","Qualitative",
           "Qualitative","Quantitative","Quantitative","Qualitative","Qualitative",
           "Qualitative","Quantitative")

Sous_type = c("Discr√®te","Discr√®te","Binaire","Discr√®te","Ordinale",
                "Nominale","Continue","Nominale","Binaire","Continue",
                "Discr√®te","Nominale","Binaire","Continue","Binaire",
                "Binaire","Continue","Discr√®te","Nominale","Binaire",
                "Binaire","Continue")

variables <- data.frame(
  Nom_de_la_variable,
  Description,
  Type,
  Sous_type,
  stringsAsFactors = FALSE
)

# Fonction de coloration conditionnelle
variables <- variables %>%
  mutate(
    Type = cell_spec(Type,
                     background = ifelse(Type=="Quantitative","#5DADE2","#58D68D"),
                     color="black", bold=TRUE, escape=FALSE),
    Sous_type = cell_spec(Sous_type,
                          background = case_when(
                            Sous_type == "Binaire"   ~ "#A3E4D7",  # vert menthe
                            Sous_type == "Discr√®te"  ~ "#85C1E9",  # bleu clair
                            Sous_type == "Ordinale"  ~ "#F7DC6F",  # jaune dor√©
                            Sous_type == "Nominale"  ~ "#F5B041",  # orange doux
                            Sous_type == "Continue"  ~ "#E59866"   # rouge ros√©
                          ),
                          color = "black",
                          escape = FALSE)
  )

# Affichage du tableau
kable(variables, "html", escape=FALSE, caption="üìä Tableau des variables avec code couleur") %>%
  kable_styling(bootstrap_options = c("striped","hover","condensed"), full_width=FALSE) %>%
  column_spec(1, bold=TRUE, color="black", background="#D6EAF8") %>%    # colonne Nom_de_la_variable
  column_spec(2, width="8cm", bold=TRUE, background="#EBF5FB") %>%       # colonne Description
  row_spec(0, bold=TRUE, color="white", background="#2C3E50")            # header
```

## - Boxplot des donn√©es Quantitative


```{r 2 Boxplot Num√©rique, echo = FALSE, fig.align='center'}
# Prendre que les variables quantitatives
vars_quanti <- Nom_de_la_variable[Type == "Quantitative"]

for (i in 0:4) {
  # Grille 2 lignes √ó 5 colonnes
  par(mfrow = c(1, 2), mar = c(4, 4, 3, 1))
  for (j in 1:2) {
    var_name <- vars_quanti[2*i+j]
    boxplot(
      data.brute[[var_name]],
      main = var_name,
      col = "#5DADE2",
      boxwex = 0.5,
      outline = TRUE,
      cex.main = 0.9,
      cex.axis = 0.9,
      las = 1,
      frame.plot = FALSE
    )
    grid(nx = NA, ny = NULL, col = "lightgray", lty = "dotted")
    }
}
par(mfrow = c(1, 1))



```

```{r 3 Barplot qualitative, echo = FALSE, fig.align='center'}
# S√©lection des variables qualitatives
vars_quali <- Nom_de_la_variable[Type == "Qualitative"]

# Grille 2 lignes √ó 5 colonnes
par(mfrow = c(2, 6), mar = c(6, 4, 3, 1)) 

for (i in 0:5) {
  # Grille 2 lignes √ó 5 colonnes
  par(mfrow = c(1, 2), mar = c(6, 4, 3, 1))
  for (j in 1:2) {
  var_name <- vars_quali[2*i+j]
  # Comptage des modalit√©s
  counts <- table(data.brute[[var_name]])
  
  # Titre avec retour √† la ligne si besoin
  main_title <- gsub("_", "\n", var_name)
  
  barplot(
    counts,
    main = main_title,
    col = "#58D68D",
    border = "gray25",
    cex.main = 0.9,
    cex.axis = 0.8,
    cex.names = 0.7,       # taille des noms des modalit√©s
    las = 2,               # rotation des labels pour qu‚Äôils soient lisibles
    frame.plot = FALSE
  )
  grid(nx = NA, ny = NULL, col = "lightgray", lty = "dotted")
  }
}


# ‚úÖ Revenir √† une seule figure
par(mfrow = c(1, 1))
```
